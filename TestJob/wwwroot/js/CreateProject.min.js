(function($){$(document).ready(function(){let EventHandl=(function(){const projectName=$("[name='projectName']");const createDate=$("[name='createDate']");const createTime=$("[name='createTime']");const projectId=$("#content_TableModel_projectId");const exampleModalLabel=$('#exampleModalLabel');const span_modal_delete=$('#span-modal-delete');const resultDelete_project=$('#resultDelete-project');const updateDate=$("[name='updateDate']");const updateTime=$("[name='updateTime']");const btn_deleteProject=$('#btn-deleteProject');const btn_modfProject=$('#btn-modfProject');const btn_modalDlgSave=$('#btn-modalDlgSave');const closeFormDialog=function(){$('#closeFormDialog').trigger('click');}
const addDisabled=function(el){el.addClass('disabled');}
const removeDisabled=function(el){el.removeClass('disabled');}
const ajaxRoute=$('body').data('ajaxRoute');return{removeDisabled:removeDisabled,addDisabled:addDisabled,projectName:projectName,createDate:createDate,createTime:createTime,updateDate:updateDate,updateTime:updateTime,span_modal_delete:span_modal_delete,btn_deleteProject:btn_deleteProject,btn_modfProject:btn_modfProject,btn_modalDlgSave:btn_modalDlgSave,resultDelete_project:resultDelete_project,closeFormDialog:closeFormDialog,exampleModalLabel:exampleModalLabel,projectId:projectId,ajaxRoute};}());(function(evObj){let idModf='false';function set_idModf(arg,start=false){evObj.removeDisabled(evObj.projectName);if(arg=='false'){evObj.createDate.val('');evObj.createTime.val('');evObj.removeDisabled(evObj.createDate);evObj.removeDisabled(evObj.createTime);evObj.addDisabled(evObj.updateDate);evObj.addDisabled(evObj.updateTime);evObj.exampleModalLabel.text('Create project');}
else{evObj.updateDate.val('');evObj.updateTime.val('');evObj.addDisabled(evObj.createDate);evObj.addDisabled(evObj.createTime);evObj.removeDisabled(evObj.updateDate);evObj.removeDisabled(evObj.updateTime);const ajaxRoute=$('body').data('ajaxRoute');if(ajaxRoute==undefined){const projectId=Get_projectId();const url='/api/Rest/dataproject/'+projectId;$.ajax(url,{type:'GET',success:function(data){if(data.result=='ok'){$('body').data('ajaxRoute',data);set_id_uploadData_ajaxRoute();}}});}
else{set_id_uploadData_ajaxRoute();}}
idModf=arg;if(!start){$('.contentTableJob').hide();$('#formDialog').show(100);$('#btn-AddProject').hide();}}
function set_id_uploadData_ajaxRoute(){const ajaxRoute=$('body').data('ajaxRoute');evObj.projectName.val(ajaxRoute.projectName);evObj.createDate.val(ajaxRoute.date);evObj.createTime.val(ajaxRoute.time);evObj.exampleModalLabel.text('Modify project');}
function getData(){let obj=new Object();obj.projectName=evObj.projectName.val();if(idModf=='false'){obj.date=evObj.createDate.val();obj.time=evObj.createTime.val();obj.projectId='';}
else{obj.projectId=evObj.projectId.val();obj.date=evObj.updateDate.val();obj.time=evObj.updateTime.val();}
return obj;}
function verify(){const data=getData();$('.dataError').empty();if(get_idModf()=='false'){if(data.projectName==''){showMessageError('Not data for projectName');return"err";}
if(data.data==''){showMessageError('Not data for createDate');return"err";}
if(data.time==''){showMessageError('Not data for createTime');return"err";}}
else{if(data.data==''&&data.time==''&&data.projectName==''){showMessageError('Not all fields are filled ');return"err";}
const dataAjax=$('body').data('ajaxRoute');if(dataAjax.date==data.data&&dataAjax.time==data.time){showMessageError('Data has not changed ');return"err";}}
return"ok"}
function showMessageError(err){const div=$('.dataError');const ul=$('<ul></ul>');const li=$('<li></li>');li.text(err);ul.append(li);div.append(ul);}
function Get_projectId(){return evObj.projectId.val();}
function get_idModf(){return idModf;}
function Get_idUpdate(){return $('#content_TableModel_idUpdate').val();}
function updateAfterSave(){const index=$('.dropdown-item').length+1;const projName=evObj.projectName.val();const a=$('<a class="dropdown-item " href="/Home/index/'+index+'">'+projName+'</a > ');$('.dropdown-menu').append(a);}
function updateAfterModf(){const modfProjectName=evObj.projectName.val();$('#spanSelProject').val(modfProjectName);}
evObj.set_idModf=set_idModf;evObj.get_idModf=get_idModf;evObj.getData=getData;evObj.verify=verify;evObj.showMessageError=showMessageError;evObj.Get_projectId=Get_projectId;evObj.Get_idUpdate=Get_idUpdate;evObj.updateAfterSave=updateAfterSave;evObj.updateAfterModf=updateAfterModf;}(EventHandl));(function(evObj){$('#formDialog').hide();$('#updateTime').timePicker();$('#createTime').timePicker();$('#updateDate').datetimepicker({timepicker:false,format:'Y-m-d',});$('#createDate').datetimepicker({timepicker:false,format:'Y-m-d',});evObj.set_idModf('false',true);if(evObj.Get_projectId()==''||evObj.Get_idUpdate()=='true'){evObj.addDisabled(evObj.btn_modfProject);evObj.addDisabled(evObj.btn_deleteProject);}}(EventHandl));(function(evObj){$('#closeFormDialog').click(function(e){$('#formDialog').hide(100);$('.contentTableJob').show(100);$('#btn-AddProject').show();});$('button.close').click(function(e){evObj.closeFormDialog();});$('#btn-AddProject').click(function(e){evObj.set_idModf('false');});$('#btn-modfProject').click(function(){evObj.set_idModf('true');});$('#btn-modalDlgSave').click(function(e){evObj.resultDelete_project.text('Пробное сообщение');});$('#modal-delProject').on('show.bs.modal',function(e){const selProject=$('#spanSelProject').text();evObj.span_modal_delete.text(selProject);})}(EventHandl));(function(evObj){$('#btn-save-changes').click(function(e){$('.dataError').empty();evObj.exampleModalLabel.text('Create project');if(evObj.verify()=="err"){e.preventDefault();return;}
const idModf=evObj.get_idModf();const data=evObj.getData();const url=idModf=='false'?'/newproject':'/modfroject';const type=idModf=='false'?'POST':'PUT';if(idModf=='false'){data.projectId='';}
$.ajax(url,{data:data,type:type,success:function(data){if(data.result=='ok'){if(idModf=="false")
evObj.updateAfterSave();else
evObj.updateAfterModf();evObj.closeFormDialog();}
else{evObj.showMessageError(data.message);}},error:function(jqXHR,status,errorMes){console.log(errorMes);}});});}(EventHandl));(function(evObj){const objTesting=new Object();(function(obTest){const btnTest_getData=$('#btnTest-getData');const div_DetailTest=$('.div-DetailTest');obTest.btnTest_getData=btnTest_getData;obTest.div_DetailTest=div_DetailTest;})(objTesting);(function(obTest){obTest.btnTest_getData.click(function(e){const lsData=evObj.getData();obTest.div_DetailTest.empty();obTest.div_DetailTest.text('check string ');console.log('check string');});})(objTesting);})(EventHandl);})})(jQuery);